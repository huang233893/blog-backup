---
title: RIP基础
summary: >-
  酥米小机器人来啦，这篇文章介绍了RIP（Routing Information
  Protocol）一种内部网关协议，基于距离矢量算法使用跳数度量路由距离和目的地址RIP分为v1和v2版本v1支持有类路由不支持VLSM通过广播更新而v2支持无类路由VLSM通过组播更新优化了网络通信运行机制包括开启RIP进程构建路由表以及四个定时器如更新定时器30秒老化定时器180秒和垃圾收集定时器120秒用于维护和防止路由信息过时触发更新机制缩短收敛时间水平分割和毒化逆转防止环路兼顾抑制计时确保路由稳定RIP报文包括命令字段版本字段等关键字段RIPV2更先进支持更多功能如路由标记等配置实践涉及宣告网络地址和设置版本帮助实施动态路由策略
categories:
  - 思科
tags:
  - 网络
  - CCNA
cover: https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/RIP%20(2).png
date: 2024-10-17 15:01:46
---

## 简介
RIP是一种内部网关协议（IGP），是一种动态路由选择协议，用于自治系统（AS）内的路由信息传递。

RIP协议基于距离矢量算法（Distance Vector Algorithms），使用“跳数”（metric）来衡量到达目的地址的路由距离。

RIP通过UDP报文进行路由进行路由信息交换，使用的端口为520.

RIP包括v1和v2两个版本

## RIP的版本比较
**<font style="background-color:#D8DAD9;">RIP V1 **
有类路由协议
不支持VLSM
广播更新255.255.255.255

**<font style="background-color:#D8DAD9;">RIP V2 **
无类路由协议
支持VLSM
组播更新224.0.0.9


## 基础运行步骤（四个定时器）
+ 开启RIP进程，宣告接口，开始接收报文，发送UDP报文
+ 根据收到的RIP报文构建自己的路由表
+ 每隔30S发送更新报文来更新维护路由表“更新定时器”
+ 路由器为自己的每条路由表项启动180S的“老化定时器”。180s内如果收到了更新报文，则重置定时器
+ 如果上面180S到期，则启动120S的“垃圾收集定时器”，同时将该路由表项度量值置为16
+ 120S过后，路由器仍未收到相应路由表项的更新，则路由器删除该表项
+ 当RIP设备收到对端cost为16的路由更新时，为防止路由震荡，启动“抑制定时器”，在这个定时器超时前，不再接受对端任何路由

## 触发更新
可以缩短网络收敛时间，一个路由表最多等待120S才能被删除（垃圾收集时间）；如果不存在触发更新，最多需要等待300S（老化时间+垃圾收集时间）

## 水平分割
+ RIP从某个接口学到的路由，不会从该接口再回发给邻居路由器。
+ 作用减少带宽损耗，防止路由环路。也解决了“坏消息传播得慢”

## 毒化逆转
+ 一个接口学来的路由项，把度量值改为16再原路发回去，也可以避免环路发生，实践中使用比较少。

## 抑制计时
+ 一条路由信息无效之后，一段时间内这条路由都处于抑制状态，即在一定时间内不再接收关于同一目的地址的路由更新。
+ 如果，路由器从一个网段上得知一条路径失效，然后，立即在另一个网段上得知这个路由有效。这个有效的信息往往是不正确的，抑制计时避免了这个问题，而且，当一条链路频繁起停时，抑制计时减少了路由的浮动，增加了网络的稳定性。

## 报文类型
> RIPV1 引用至华为文档
>
> ![](https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/RIP%20(2).png)
>

+ **命令字段**（Command）：该字段用于标识RIP报文的类型。取值为1表示为Request报文，取值为2表示Response报文。 
+ **版本字段** （Version）：在RIP-1中，该字段取值为1。 
+ **址族标识符** （Address family identifier）：该字段值为2表示IP协议，如果该报文为Request报文并且用于向直连路由设备请求整张路由表，则该字段值被设置为0，同时这个Request报文中包含且仅包含一个路由条目，该路由的目的网络地址为0.0.0.0，度量值为16。 
+ **IP地址** （IP address）：路由的目的网络地址。 
+ **度量值** （Metric）：该路由的度量值。 

> RIP V2 引用至华为文档
>
> ![](https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/RIP%20(1).png)
>

+ **命令字段** （Command）：该字段用于标识RIP报文的类型。取值为1表示为Request报文，取值为2表示Response报文。 
+ **版本字段** （Version）：在RIP-2中，该字段取值为2。 
+ **地址族标识符** （Address Family Identifier）：与RIP-1类似。 
+ **路由标记**（Route Tag）：用于为路由设置标记信息，可以在路由策略中根据Tag对路由进行灵活的控制。例如，当一条外部路由被引入RIP从而形成一条RIP路由时，RIP可以为该路由设置路由标记，当这条路由在整个RIP路由域传播时，路由标记不会丢失。 
+ **IP地址** （IP Address）：路由的目的网络地址。 
+ **网络掩码** （Subnet Mask）：用于存储路由条目的目的网络掩码，RIP-2进而支持可变长子网掩码（VLSM，Variable Length Subnet Mask），支持路由聚合和CIDR（Classless Inter-Domain Routing）。 
+ **下一跳** （Next Hop）：RIP-2定义了该字段，避免路由设备在多路访问网络上可以表面次优路径现象，在广播网上可以选择到最优下一跳地址。 
+ **度量值** （Metric）：该路由的度量值。 

## 配置实践
### 基础配置
```plain
Router(config)# router rip
Router(config-if)# network address #宣告网段
Router(config-if)# version 2 #使用RIPv2版本的RIP协议
```

                                                                          
   
 